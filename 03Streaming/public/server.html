<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Servidor de Streaming</title>
  </head>
  <body>
    <h1>Servidor de Streaming</h1>
    <p>Esta página transmite en tiempo real el streaming de la cámara web</p>
    <video id="video"></video>
    <canvas id="canvas" width="720" height="720"></canvas>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      (function(d, io){
        'use strict'

        var io = io(),
            startCamera = false,
            video = d.querySelector('#video'),
            canvas = d.querySelector('#canvas'),
            context = canvas.getContext('2d')

        navigator.streaming = (
          navigator.getUserMedia ||
          navigator.webkitGetUserMedia ||
          navigator.mozGetUserMedia ||
          navigator.msGetUserMedia
        )

        navigator.streaming({
          video: true,
          audio: false
        }, function(stream){
          startCamera = true
          video.src = window.URL.createObjectURL(stream)
        }, function(err){
          alert('Error al acceder a la cámara web: '+ err)
        })

      })(document, io)
    </script>
  </body>
</html>
